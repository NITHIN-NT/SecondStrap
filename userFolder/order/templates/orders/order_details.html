{% extends 'base.html' %}
{% load static %}

{% block title %}Order Details #{{ order.order_number }}{% endblock %}

{% block extra_styles %}
<link rel="stylesheet" href="{% static "css/order/order_details.css" %}">
{% endblock extra_styles %}

{% block content %}
<div class="od-wrapper">
    <div class="od-container">
        
        <div class="od-header-nav">
            <a href="#" class="back-link">
                <i class='bx bx-left-arrow-alt'></i> Back to Orders
            </a>
            <div class="od-title-row">
                <div class="od-title-left">
                    <h1>Order Details</h1>
                    <div class="od-meta">
                        <span>Order #: {{ order.order_id}}</span>
                        <span>•</span>
                        <span>Placed on: {{ order.created_at }}</span>
                    </div>
                </div>
                <div>
                    <a href="#" class="btn-invoice-outline">
                        <i class='bx bx-file-blank'></i> Download Invoice
                    </a>
                </div>
            </div>
        </div>

        <div class="od-card">
            <h3 class="od-card-title">Order Status</h3>
            <div class="status-header">
                <div class="status-icon-box">
                    <i class='bx bx-check'></i>
                </div>
                <div class="status-text">
                    <h3>{{order.order_status}}</h3>
                    <p>Delivered on June 14, 2023</p>
                </div>
            </div>

            <div class="progress-track">
                <span>Order Placed</span>
                <span>Delivered</span>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar-fill" style="width: 100%;"></div>
            </div>

            {% comment %} <div class="tracking-info-row">
                <div class="ti-col">
                    <h4>Tracking Number</h4>
                    <p>TRK8374626374</p>
                </div>
                <div class="ti-col">
                    <h4>Carrier</h4>
                    <p>FedEx</p>
                </div>
                <div class="ti-col">
                    <a href="#" class="track-link">Track Package <i class='bx bx-right-arrow-alt'></i></a>
                </div>
            </div> {% endcomment %}
        </div>

        <div class="od-card">
            <h3 class="od-card-title">Tracking History</h3>
            <div class="timeline">
                
                <div class="timeline-item">
                    <div class="timeline-icon"><i class='bx bx-check'></i></div>
                    <div class="timeline-content">
                        <h4>Order Placed</h4>
                        <span>{{order.created_at}}</span>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-icon"><i class='bx bx-check'></i></div>
                    <div class="timeline-content">
                        <h4>Processing</h4>
                        <span>June 12, 2023 at 2:45 PM</span>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-icon"><i class='bx bx-check'></i></div>
                    <div class="timeline-content">
                        <h4>Shipped</h4>
                        <span>June 13, 2023 at 8:15 AM</span>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-icon"><i class='bx bx-check'></i></div>
                    <div class="timeline-content">
                        <h4>Out for Delivery</h4>
                        <span>June 14, 2023 at 8:30 AM</span>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-icon"><i class='bx bx-check'></i></div>
                    <div class="timeline-content">
                        <h4>Delivered</h4>
                        <span>June 14, 2023 at 2:10 PM</span>
                    </div>
                </div>

            </div>
        </div>

        <div class="od-card">
            <h3 class="od-card-title">Items in Your Order</h3>
            {% for order_item in order_items %}
                <div class="item-row">
                    <img src="{{order_item.variant.product.image.url}}" alt="Product" class="item-img">
                    <div class="item-details">
                        <span class="item-name">{{order_item.product_name}}</span>
                        <div class="item-meta"> {{order_item.variant.size}} • Qty {{order_item.quantity}}</div>
                    </div>
                    <div class="item-price-group">
                        <span class="item-unit-price">₹{{order_item.price_at_purchase}}</span>
                        <span class="item-total-price">₹{{order_item.get_total_price}}</span>
                    </div>
            </div>
            {% endfor %}

        </div>

        <div class="address-grid">
            
            <div class="od-card">
                <h3 class="od-card-title">Shipping Information</h3>
                <div class="address-lines">
                    <strong>{{order.shipping_address_name}}</strong> {{order.shipping_address_line_1}}<br>
                    {{order.shipping_city}} {{order.shipping_pincode}}<br>
                    {{order.shipping_state}}
                </div>
            </div>

            <div class="od-card">
                <h3 class="od-card-title">Billing Information</h3>
                <div class="address-lines">
                    <strong>{{order.shipping_address_name}}</strong> {{order.shipping_address_line_1}}<br>
                    {{order.shipping_city}} {{order.shipping_pincode}}<br>
                    {{order.shipping_state}}
                </div>
                
                <div class="payment-info">
                    <span class="payment-label">{% if payment_method == cod %}Cash on Delivary{% endif %}</span>
                    <span class="payment-value">{% if payment_method == code %}{% endif %}</span>
                </div>
            </div>

        </div>
        <br>

        <div class="od-card">
            <h3 class="od-card-title">Order Summary</h3>
            
            <div class="summary-row">
                <span>Subtotal</span>
                <span>₹{{order.total_price}}</span>
            </div>
            <div class="summary-row">
                <span>Shipping</span>
                <span>₹{{shipping}}</span>
            </div>
            <div class="summary-row">
                <span>Tax</span>
                <span>₹{{tax}}</span>
            </div>
            <div class="summary-row">
                <span>Discount</span>
                <span>-₹{{discount}}</span>
            </div>

            <div class="summary-row total">
                <span>Total</span>
                <span>₹{{order.final_price}}</span>
            </div>

            <button class="btn-download-black">
                <i class='bx bx-download'></i> Download Invoice
            </button>
        </div>

    </div>
</div>
{% endblock content %}